<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>楼层跳转-按需加载</title>
    <style>

        * {
            margin: 0;
            padding: 0;
            border: 0;
        }
        header {
            width: 100%;
            height: 80px;
            line-height: 80px;
            background: #333;
            text-align: center;
            position: fixed;
            top: 0;
            left: 0;
        }
        .search {
            width: 200px;
            height: 30px;
            line-height: 30px;
            background: #7dc3fe;
            text-align: center;
            color: #000;
            position: fixed;
            top: -40px;
            right: 10px;
        }
        main {
            width: 1226px;
            margin: 0 auto;
        }
        main section {
            width: 100%;
            height: 800px;
            background: #cccccc;
            margin: 80px auto;
            display: flex;
            justify-content: space-around;
            align-items: center;
            flex-flow: wrap;
        }
        main section img {
            width: 405px;
            height: 151px;
        }
        footer {
            width: 100%;
            height: 80px;
            line-height: 80px;
            background: #333;
            text-align: center;
            position: fixed;
            bottom: 0;
            left: 0;
        }
        .list {
            width: 40px;
            height: 300px;
            display: flex;
            justify-content: space-around;
            flex-flow: column;
            position: fixed;
            left: -50px;
            top: 300px;
            transition: all 1s;
        }
        .list .floor {
            width: 40px;
            height: 30px;
            border: 1px solid #000;
            text-align: center;
            font-size: 20px;
            line-height: 30px;
            color: #fff;
            background: #ccc;
            cursor: pointer;
        }
        .list .active {
            background: pink;
        }
    </style>

</head>
<body>

<header>这是顶部</header>
<div class="search">搜索</div>
<main>
    <section>
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-1.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-2.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-3.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-4.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-5.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-5.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-4.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-3.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-2.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-1.jpg" alt="">
    </section>
    <section>
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-1.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-2.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-3.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-4.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-5.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-5.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-4.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-3.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-2.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-1.jpg" alt="">
    </section>
    <section>
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-1.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-2.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-3.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-4.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-5.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-5.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-4.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-3.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-2.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-1.jpg" alt="">
    </section>
    <section>
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-1.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-2.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-3.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-4.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-5.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-5.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-4.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-3.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-2.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-1.jpg" alt="">
    </section>
    <section>
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-1.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-2.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-3.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-4.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-5.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-5.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-4.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-3.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-2.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-1.jpg" alt="">
    </section>
    <section>
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-1.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-2.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-3.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-4.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-5.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-5.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-4.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-3.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-2.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-1.jpg" alt="">
    </section>
    <section>
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-1.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-2.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-3.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-4.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-5.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-5.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-4.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-3.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-2.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-1.jpg" alt="">
    </section>
    <section>
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-1.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-2.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-3.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-4.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-5.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-5.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-4.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-3.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-2.jpg" alt="">
        <img src="../../xiaomi/img/loading.gif" imgsrc="../xiaomi/img/main-banner-1.jpg" alt="">
    </section>
</main>

<div class="list">
    <div class="floor">1</div>
    <div class="floor">2</div>
    <div class="floor">3</div>
    <div class="floor">4</div>
    <div class="floor">5</div>
    <div class="floor">6</div>
    <div class="floor">7</div>
    <div class="floor">8</div>
</div>

<footer>这是底部</footer>


</body>
</html>
<script src="../../公用代码/公用js/animate.js"></script>
<script>
    // 获取模块集合
    let section = document.querySelectorAll("section");
    // 获取楼层集合
    let list = document.querySelector(".list");
    // 获取楼层
    let floor = document.querySelectorAll(".floor");
    // 获取搜索框
    let search = document.querySelector(".search");
    // 声明一个空数组，准备输出模块集合中每个模块距离浏览器顶部的距离
    let arr = [];
    //声明一个颜色数组，以便做点击事件使用
    let colorarr = ["yellow","green","red","blue","pink","black","#3ee3fb","#ff6700"];
    // 遍历模块集合将距离数字放入声明的空数组中
    section.forEach((val,index) => {
        arr.push(val.offsetTop);
    });
    // 在窗口发生变化时才能动态获取滚动条距离窗口顶部的距离，所以都需要在此函数里进行操作
    window.onscroll = function () {
        // 获取滚动条距离窗口顶部的动态尺寸
        let bodytop = document.body.scrollTop || document.documentElement.scrollTop;
        // 当页面滚动超过指定的距离尺寸的时候，楼层模块及搜索框显示
        if (bodytop > 500) {
            list.style.left = "10px";
            search.style.top = "10px";
        };
        // 当页面滚动回指定的距离尺寸范围的时候，楼层模块及搜索框隐藏
        if (bodytop < 500) {
            list.style.left = "-50px";
            search.style.top = "-50px";
        };
        // 遍历获取arr数组中的每一个尺寸
        arr.forEach((val,index) => {
            // 将滚动条动态尺寸与模块距离浏览器顶部的距离尺寸对比
            if (val+100 < bodytop+innerHeight/1.3) {
                // 设置显示对应的模块，对应的楼层高亮，并显示对应的颜色
                for (let i = 0; i < section.length; i++) {
                    floor[i].style.backgroundColor = "";
                };
                floor[index].style.backgroundColor = colorarr[index];
                // 获取单个模块儿中的图片集合
                let imgs = section[index].querySelectorAll("img");
                imgs.forEach((vals) => {
                    // 获取当前模块所有图片的地址
                    let url = vals.getAttribute("imgsrc");
                    // 将图片地址赋给src属性以便加载图片
                    vals.setAttribute("src",url);
                })
            }
            // 鼠标点击时滚动到相应的模块
            floor[index].onclick = function () {
                // 点击后模块变成相应的颜色
                floor[index].style.backgroundColor = colorarr[index];
                // 用animate函数设置页面滚动
                animate(document.body,{scrolltop:arr[index]-100});
                animate(document.documentElement,{scrollTop:arr[index]-100});
            }
        })
    }
</script>



<!--1.按需加载-->
<!--当页面滚动到一定位置时，让当前位置的图片再进行加载：-->
<!--获取    页面滚动条的位置-->
<!--每一个模块的offsetTop[];arr[];-->
<!--判断bodytop>=arr[index]满足-->
<!--获取当前位置的所有图片[];list[index].querSelector("img");-->
<!--获取每一张图片的自定义属性值，设置到src上；-->

<!--2.楼层跳转-->
<!--点击某个楼层时，页面滚动对应位置-->
<!--animate(bodytop，{scrollTop:arr[index]});-->

<!--3.优化-->
<!--当页面滚动到一定位置时，再让左侧列表和顶部搜索出现，改变左侧列表的选中颜色colorarr[];-->
